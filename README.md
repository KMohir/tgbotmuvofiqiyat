# Kapital Sheet Bot - Telegram Bot для учета финансов

## Описание
Telegram бот для учета финансовых операций (кирим/чиқим) с интеграцией Google Sheets и PostgreSQL.

## Установка и запуск

### 1. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 2. Настройка переменных окружения
Создайте файл `.env` в корневой директории:
```env
BOT_TOKEN=your_telegram_bot_token
DATABASE_URL=postgresql://username:password@localhost:5432/database_name
GOOGLE_SHEETS_CREDENTIALS_FILE=path_to_credentials.json
```

### 3. Запуск бота
```bash
python bot.py
```

## Мониторинг и логирование

### Логи
Бот создает файл `bot.log` с детальными логами всех операций.

### Основные команды для мониторинга
- `/check_sheets` - проверка состояния Google Sheets
- `/userslist` - список пользователей
- `/admins_list` - список администраторов
- `/pending_approvals` - ожидающие одобрения операции

## Решение проблем

### 1. Ошибка "Query is too old and response timeout expired"
Эта ошибка возникает когда callback query истек. Бот автоматически обрабатывает такие ошибки.

**Решение:** Перезапустите бота или подождите - ошибка не критична.

### 2. Предупреждение "Updates were skipped successfully"
Это нормальное поведение - бот пропускает обновления, которые пришли пока он был неактивен.

**Решение:** Не требует действий, это информационное сообщение.

### 3. Проблемы с подключением к базе данных
Проверьте:
- Правильность DATABASE_URL в .env
- Доступность PostgreSQL сервера
- Права доступа пользователя

### 4. Проблемы с Google Sheets
Проверьте:
- Правильность пути к credentials.json
- Права доступа к Google Sheets
- Квоты API

## Структура проекта
```
├── bot.py              # Основной файл бота
├── requirements.txt     # Зависимости Python
├── .env               # Переменные окружения
├── bot.log            # Логи бота (создается автоматически)
└── README.md          # Этот файл
```

## Поддержка
При возникновении проблем проверьте логи в файле `bot.log` и убедитесь, что все переменные окружения настроены правильно.
