#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Centris Bot PowerPoint Presentation Creator V5
/set_group_video va /add_season buyruqlari haqida to'liq tushuntirish
prezentatsiya_v2.pptx ga o'xshash ko'rinishda
"""

from pptx import Presentation
from pptx.util import Inches, Pt
from pptx.enum.text import PP_ALIGN
from pptx.dml.color import RGBColor
from pptx.enum.shapes import MSO_SHAPE
from pptx.dml.color import RGBColor
import os

def create_title_slide(prs, title, subtitle):
    """Title slide yaratish"""
    slide_layout = prs.slide_layouts[0]
    slide = prs.slides.add_slide(slide_layout)
    
    title_shape = slide.shapes.title
    subtitle_shape = slide.placeholders[1]
    
    title_shape.text = title
    subtitle_shape.text = subtitle
    
    # Styling
    title_shape.text_frame.paragraphs[0].font.size = Pt(44)
    title_shape.text_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    subtitle_shape.text_frame.paragraphs[0].font.size = Pt(24)
    subtitle_shape.text_frame.paragraphs[0].font.color.rgb = RGBColor(128, 128, 128)
    
    return slide

def create_content_slide(prs, title, content):
    """Content slide yaratish"""
    slide_layout = prs.slide_layouts[1]
    slide = prs.slides.add_slide(slide_layout)
    
    title_shape = slide.shapes.title
    content_shape = slide.placeholders[1]
    
    title_shape.text = title
    title_shape.text_frame.paragraphs[0].font.size = Pt(36)
    title_shape.text_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    
    content_shape.text = content
    
    # Content styling
    for paragraph in content_shape.text_frame.paragraphs:
        paragraph.font.size = Pt(18)
        paragraph.font.color.rgb = RGBColor(64, 64, 64)
    
    return slide

def create_command_detailed_slide(prs, command, description, functions, examples, workflow):
    """Buyruq haqida batafsil ma'lumot slide yaratish"""
    slide_layout = prs.slide_layouts[6]
    slide = prs.slides.add_slide(slide_layout)
    
    # Title
    title_box = slide.shapes.add_textbox(Inches(1), Inches(0.5), Inches(8), Inches(1))
    title_frame = title_box.text_frame
    title_frame.text = f"üì± {command} - Batafsil Ma'lumot"
    title_frame.paragraphs[0].font.size = Pt(32)
    title_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    title_frame.paragraphs[0].alignment = PP_ALIGN.CENTER
    
    # Description
    desc_box = slide.shapes.add_textbox(Inches(1), Inches(1.8), Inches(8), Inches(1))
    desc_frame = desc_box.text_frame
    desc_frame.text = description
    desc_frame.paragraphs[0].font.size = Pt(18)
    desc_frame.paragraphs[0].font.color.rgb = RGBColor(64, 64, 64)
    desc_frame.paragraphs[0].alignment = PP_ALIGN.CENTER
    
    # Functions
    func_box = slide.shapes.add_textbox(Inches(1), Inches(3.2), Inches(3.8), Inches(2.5))
    func_frame = func_box.text_frame
    func_frame.text = f"üîπ **Funksiyalar:**\n{functions}"
    func_frame.paragraphs[0].font.size = Pt(16)
    func_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    func_frame.paragraphs[0].font.bold = True
    
    for paragraph in func_frame.paragraphs[1:]:
        paragraph.font.size = Pt(14)
        paragraph.font.color.rgb = RGBColor(64, 64, 64)
    
    # Examples
    ex_box = slide.shapes.add_textbox(Inches(5.2), Inches(3.2), Inches(3.8), Inches(2.5))
    ex_frame = ex_box.text_frame
    ex_frame.text = f"üí° **Misollar:**\n{examples}"
    ex_frame.paragraphs[0].font.size = Pt(16)
    ex_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    ex_frame.paragraphs[0].font.bold = True
    
    for paragraph in ex_frame.paragraphs[1:]:
        paragraph.font.size = Pt(14)
        paragraph.font.color.rgb = RGBColor(64, 64, 64)
    
    # Workflow
    workflow_box = slide.shapes.add_textbox(Inches(1), Inches(6), Inches(8), Inches(1.5))
    workflow_frame = workflow_box.text_frame
    workflow_frame.text = f"üîÑ **Ishlash Jarayoni:**\n{workflow}"
    workflow_frame.paragraphs[0].font.size = Pt(16)
    workflow_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    workflow_frame.paragraphs[0].font.bold = True
    
    for paragraph in workflow_frame.paragraphs[1:]:
        paragraph.font.size = Pt(14)
        paragraph.font.color.rgb = RGBColor(64, 64, 64)
    
    return slide

def create_workflow_diagram_slide(prs, title, workflow_steps):
    """Workflow diagramma slide yaratish (text bilan)"""
    slide_layout = prs.slide_layouts[6]
    slide = prs.slides.add_slide(slide_layout)
    
    # Title
    title_box = slide.shapes.add_textbox(Inches(1), Inches(0.5), Inches(8), Inches(1))
    title_frame = title_box.text_frame
    title_frame.text = title
    title_frame.paragraphs[0].font.size = Pt(32)
    title_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    title_frame.paragraphs[0].alignment = PP_ALIGN.CENTER
    
    # Workflow steps
    workflow_box = slide.shapes.add_textbox(Inches(1), Inches(2), Inches(8), Inches(5))
    workflow_frame = workflow_box.text_frame
    workflow_frame.text = workflow_steps
    
    # Content styling
    for paragraph in workflow_frame.paragraphs:
        paragraph.font.size = Pt(16)
        paragraph.font.color.rgb = RGBColor(64, 64, 64)
        if paragraph.text.startswith("1Ô∏è‚É£") or paragraph.text.startswith("2Ô∏è‚É£") or paragraph.text.startswith("3Ô∏è‚É£") or paragraph.text.startswith("4Ô∏è‚É£") or paragraph.text.startswith("5Ô∏è‚É£"):
            paragraph.font.bold = True
            paragraph.font.color.rgb = RGBColor(0, 102, 204)
    
    return slide

def create_admin_commands_overview_slide(prs):
    """Admin buyruqlari haqida umumiy ma'lumot"""
    slide_layout = prs.slide_layouts[6]
    slide = prs.slides.add_slide(slide_layout)
    
    # Title
    title_box = slide.shapes.add_textbox(Inches(1), Inches(0.5), Inches(8), Inches(1))
    title_frame = title_box.text_frame
    title_frame.text = "‚öôÔ∏è Admin Buyruqlari - Umumiy Ko'rinish"
    title_frame.paragraphs[0].font.size = Pt(32)
    title_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    title_frame.paragraphs[0].alignment = PP_ALIGN.CENTER
    
    # Admin commands overview
    commands_text = """üîπ **Guruh Boshqaruvi:**
   ‚Ä¢ /set_group_video - Video sozlamalari belgilash
   ‚Ä¢ /show_group_video_settings - Sozlamalarni ko'rish
   ‚Ä¢ /update_group_names - Guruh nomlarini yangilash

üîπ **Video Boshqaruvi:**
   ‚Ä¢ /add_season - Yangi mavsum qo'shish
   ‚Ä¢ /send_specific_video - Maxsus video yuborish
   ‚Ä¢ /update_video_progress - Progress yangilash

üîπ **Sistem Boshqaruvi:**
   ‚Ä¢ /send_all_planned_videos - Barcha videolarni yuborish
   ‚Ä¢ /test_send_video_all_groups - Test video yuborish
   ‚Ä¢ /admin_help - Admin buyruqlari haqida yordam

üîπ **Xavfsizlik:**
   ‚Ä¢ Admin huquqini tekshirish
   ‚Ä¢ Guruh ruxsatini tekshirish
   ‚Ä¢ Foydalanuvchi huquqlarini boshqarish"""
    
    # Content
    content_box = slide.shapes.add_textbox(Inches(1), Inches(2), Inches(8), Inches(5))
    content_frame = content_box.text_frame
    content_frame.text = commands_text
    
    # Content styling
    for paragraph in content_frame.paragraphs:
        paragraph.font.size = Pt(16)
        paragraph.font.color.rgb = RGBColor(64, 64, 64)
        if paragraph.text.startswith("üîπ"):
            paragraph.font.bold = True
            paragraph.font.color.rgb = RGBColor(0, 102, 204)
    
    return slide

def create_security_system_slide(prs):
    """Xavfsizlik tizimi slide yaratish"""
    slide_layout = prs.slide_layouts[6]
    slide = prs.slides.add_slide(slide_layout)
    
    # Title
    title_box = slide.shapes.add_textbox(Inches(1), Inches(0.5), Inches(8), Inches(1))
    title_frame = title_box.text_frame
    title_frame.text = "üîí Xavfsizlik Tizimi va Admin Huquqlari"
    title_frame.paragraphs[0].font.size = Pt(32)
    title_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    title_frame.paragraphs[0].alignment = PP_ALIGN.CENTER
    
    # Security system
    security_text = """üîê **Admin Huquqlari:**
   ‚Ä¢ **is_admin()** - Oddiy admin huquqini tekshirish
   ‚Ä¢ **is_super_admin()** - Super-admin huquqini tekshirish
   ‚Ä¢ **check_group_whitelist()** - Guruh ruxsatini tekshirish

üõ°Ô∏è **Xavfsizlik Choralari:**
   ‚Ä¢ Faqat ruxsat berilgan guruhlar
   ‚Ä¢ Admin buyruqlarini himoya qilish
   ‚Ä¢ Input validation va sanitization
   ‚Ä¢ Rate limiting va spam himoyasi

üîë **Huquq Darajalari:**
   ‚Ä¢ **Foydalanuvchi** - Faqat video ko'rish
   ‚Ä¢ **Admin** - Guruh sozlamalari, video yuborish
   ‚Ä¢ **Super-Admin** - Mavsum qo'shish, barcha sozlamalar

üíª **Xavfsizlik Funksiyalari:**
   ‚Ä¢ check_user_permissions()
   ‚Ä¢ validate_admin_command()
   ‚Ä¢ secure_database_query()
   ‚Ä¢ audit_log_admin_actions()"""
    
    # Content
    content_box = slide.shapes.add_textbox(Inches(1), Inches(2), Inches(8), Inches(5))
    content_frame = content_box.text_frame
    content_frame.text = security_text
    
    # Content styling
    for paragraph in content_frame.paragraphs:
        paragraph.font.size = Pt(16)
        paragraph.font.color.rgb = RGBColor(64, 64, 64)
        if paragraph.text.startswith("üîê") or paragraph.text.startswith("üõ°Ô∏è") or paragraph.text.startswith("üîë") or paragraph.text.startswith("üíª"):
            paragraph.font.bold = True
            paragraph.font.color.rgb = RGBColor(0, 102, 204)
    
    return slide

def create_database_integration_slide(prs):
    """Database integratsiyasi slide yaratish"""
    slide_layout = prs.slide_layouts[6]
    slide = prs.slides.add_slide(slide_layout)
    
    # Title
    title_box = slide.shapes.add_textbox(Inches(1), Inches(0.5), Inches(8), Inches(1))
    title_frame = title_box.text_frame
    title_frame.text = "üóÑÔ∏è Database Integratsiyasi va So'rovlar"
    title_frame.paragraphs[0].font.size = Pt(32)
    title_frame.paragraphs[0].font.color.rgb = RGBColor(0, 102, 204)
    title_frame.paragraphs[0].alignment = PP_ALIGN.CENTER
    
    # Database integration
    db_text = """üìä **Asosiy Jadval:**
   ‚Ä¢ **users** - Foydalanuvchilar ma'lumotlari
   ‚Ä¢ **group_video_settings** - Guruh video sozlamalari
   ‚Ä¢ **videos** - Video ma'lumotlari va URL lar
   ‚Ä¢ **seasons** - Mavsum ma'lumotlari

üîç **SET_GROUP_VIDEO So'rovlari:**
   ‚Ä¢ UPDATE group_video_settings SET centris_season = %s
   ‚Ä¢ UPDATE group_video_settings SET golden_season = %s
   ‚Ä¢ INSERT INTO group_video_settings (group_id, group_name, ...)

‚ûï **ADD_SEASON So'rovlari:**
   ‚Ä¢ INSERT INTO videos (season_id, url, title, project_type)
   ‚Ä¢ INSERT INTO seasons (project_type, season_number)
   ‚Ä¢ UPDATE video_progress SET total_videos = total_videos + 1

üîó **Bog'lanishlar:**
   ‚Ä¢ group_video_settings ‚Üî videos (One-to-Many)
   ‚Ä¢ videos ‚Üî seasons (Many-to-One)
   ‚Ä¢ users ‚Üî group_video_settings (Many-to-Many)

üíæ **PostgreSQL Xususiyatlari:**
   ‚Ä¢ psycopg2 connector
   ‚Ä¢ Connection pooling
   ‚Ä¢ Transaction management
   ‚Ä¢ Error handling va rollback"""
    
    # Content
    content_box = slide.shapes.add_textbox(Inches(1), Inches(2), Inches(8), Inches(5))
    content_frame = content_box.text_frame
    content_frame.text = db_text
    
    # Content styling
    for paragraph in content_frame.paragraphs:
        paragraph.font.size = Pt(16)
        paragraph.font.color.rgb = RGBColor(64, 64, 64)
        if paragraph.text.startswith("üìä") or paragraph.text.startswith("üîç") or paragraph.text.startswith("‚ûï") or paragraph.text.startswith("üîó") or paragraph.text.startswith("üíæ"):
            paragraph.font.bold = True
            paragraph.font.color.rgb = RGBColor(0, 102, 204)
    
    return slide

def main():
    """Asosiy funksiya"""
    print("üé¨ Centris Bot PowerPoint Presentation V5 yaratilmoqda...")
    print("üì± /set_group_video va /add_season buyruqlari haqida to'liq tushuntirish")
    print("üéØ prezentatsiya_v2.pptx ga o'xshash ko'rinishda")
    
    # Yangi presentation yaratish
    prs = Presentation()
    
    # Slide 1: Title
    create_title_slide(
        prs,
        "üé¨ CENTRIS TOWERS & GOLDEN LAKE",
        "Admin Buyruqlari va Funksiyalari\n\n/set_group_video va /add_season haqida to'liq ma'lumot\n\nTayyorladi: AI Assistant\nSana: 31.08.2025"
    )
    
    # Slide 2: Project Overview
    create_content_slide(
        prs,
        "üìã Loyiha va Admin Buyruqlari Haqida",
        """‚Ä¢ Centris Towers va Golden Lake loyihalari uchun Telegram bot
‚Ä¢ Admin panel orqali guruh va video boshqaruvi
‚Ä¢ /set_group_video - Guruh uchun video sozlamalari belgilash
‚Ä¢ /add_season - Yangi mavsum va videolar qo'shish
‚Ä¢ Xavfsizlik tizimi va admin huquqlari
‚Ä¢ PostgreSQL ma'lumotlar bazasi integratsiyasi
‚Ä¢ Professional arxitektura va kod sifat
‚Ä¢ Barcha admin funksiyalari to'liq ko'rsatildi"""
    )
    
    # Slide 3: Admin Commands Overview
    create_admin_commands_overview_slide(prs)
    
    # Slide 4: SET_GROUP_VIDEO Command Detailed
    create_command_detailed_slide(
        prs,
        "/set_group_video",
        "Guruh uchun video sozlamalarini belgilash va boshqarish",
        """‚Ä¢ set_group_video_handler() - Asosiy handler
‚Ä¢ update_group_settings() - Sozlamalarni yangilash
‚Ä¢ check_admin_permissions() - Admin huquqini tekshirish
‚Ä¢ validate_group_exists() - Guruh mavjudligini tekshirish
‚Ä¢ update_database_settings() - Database ni yangilash
‚Ä¢ send_confirmation_message() - Tasdiqlash xabari""",
        """‚Ä¢ /set_group_video centris 2
‚Ä¢ /set_group_video golden 3
‚Ä¢ /set_group_video centris 1 golden 4
‚Ä¢ /set_group_video all 5""",
        """1Ô∏è‚É£ Admin huquqini tekshirish
2Ô∏è‚É£ Guruh mavjudligini tekshirish
3Ô∏è‚É£ Loyiha va mavsum parametrlarini olish
4Ô∏è‚É£ Database sozlamalarini yangilash
5Ô∏è‚É£ Tasdiqlash xabarini yuborish"""
    )
    
    # Slide 5: ADD_SEASON Command Detailed
    create_command_detailed_slide(
        prs,
        "/add_season",
        "Yangi mavsum va videolar qo'shish (Super-Admin)",
        """‚Ä¢ add_season_handler() - Asosiy handler
‚Ä¢ check_super_admin_permissions() - Super-admin huquqini tekshirish
‚Ä¢ validate_video_url() - Video URL ni tekshirish
‚Ä¢ insert_new_season() - Yangi mavsum qo'shish
‚Ä¢ insert_video_records() - Video yozuvlarini qo'shish
‚Ä¢ update_progress_tracking() - Progress kuzatishni yangilash""",
        """‚Ä¢ /add_season centris 5 https://example.com/video.mp4
‚Ä¢ /add_season golden 4 https://example.com/golden.mp4
‚Ä¢ /add_season centris 6 https://example.com/centris6.mp4
‚Ä¢ /add_season golden 5 https://example.com/golden5.mp4""",
        """1Ô∏è‚É£ Super-admin huquqini tekshirish
2Ô∏è‚É£ Video URL ni tekshirish va validatsiya qilish
3Ô∏è‚É£ Yangi mavsum yozuvini qo'shish
4Ô∏è‚É£ Video ma'lumotlarini database ga saqlash
5Ô∏è‚É£ Progress kuzatishni yangilash va tasdiqlash"""
    )
    
    # Slide 6: SET_GROUP_VIDEO Workflow
    create_workflow_diagram_slide(
        prs,
        "üîÑ /set_group_video - Ishlash Jarayoni",
        """1Ô∏è‚É£ **Admin Buyruqni Yuboradi:**
   /set_group_video centris 2

2Ô∏è‚É£ **Huquqni Tekshirish:**
   is_admin() ‚Üí True/False
   check_group_whitelist() ‚Üí Guruh ruxsati

3Ô∏è‚É£ **Parametrlarni Olish:**
   project = "centris"
   season = 2
   group_id = current_group_id

4Ô∏è‚É£ **Database Yangilash:**
   UPDATE group_video_settings 
   SET centris_season = 2 
   WHERE group_id = %s

5Ô∏è‚É£ **Tasdiqlash Xabari:**
   "‚úÖ Centris Towers mavsum 2 dan boshlab videolar yuboriladi" """
    )
    
    # Slide 7: ADD_SEASON Workflow
    create_workflow_diagram_slide(
        prs,
        "üîÑ /add_season - Ishlash Jarayoni",
        """1Ô∏è‚É£ **Super-Admin Buyruqni Yuboradi:**
   /add_season centris 5 https://example.com/video.mp4

2Ô∏è‚É£ **Super-Admin Huquqini Tekshirish:**
   is_super_admin() ‚Üí True/False
   check_super_admin_permissions() ‚Üí Huquq mavjudligi

3Ô∏è‚É£ **Video URL ni Tekshirish:**
   validate_video_url() ‚Üí URL to'g'ri/noto'g'ri
   check_video_accessibility() ‚Üí Video mavjudligi

4Ô∏è‚É£ **Database ga Qo'shish:**
   INSERT INTO seasons (project_type, season_number)
   INSERT INTO videos (season_id, url, title, project_type)

5Ô∏è‚É£ **Progress Yangilash:**
   UPDATE video_progress SET total_videos = total_videos + 1
   "‚úÖ Centris Towers mavsum 5 qo'shildi, 1 ta video" """
    )
    
    # Slide 8: Security System
    create_security_system_slide(prs)
    
    # Slide 9: Database Integration
    create_database_integration_slide(prs)
    
    # Slide 10: Command Parameters and Validation
    create_content_slide(
        prs,
        "üîç Buyruq Parametrlari va Validatsiya",
        """üîπ **/set_group_video parametrlari:**
   ‚Ä¢ project: "centris" yoki "golden" yoki "all"
   ‚Ä¢ season_number: 1, 2, 3, 4, 5... (integer)
   ‚Ä¢ group_id: Avtomatik olinadi (current group)

üîπ **/add_season parametrlari:**
   ‚Ä¢ project: "centris" yoki "golden"
   ‚Ä¢ season_number: Yangi mavsum raqami
   ‚Ä¢ video_url: Video fayl URL si (https://...)

üîπ **Validatsiya Qoidalari:**
   ‚Ä¢ Admin huquqini tekshirish
   ‚Ä¢ Guruh mavjudligini tekshirish
   ‚Ä¢ Video URL to'g'riligini tekshirish
   ‚Ä¢ Mavsum raqami mantiqiy ekanligini tekshirish
   ‚Ä¢ Database xatoliklarini qayta ishlash"""
    )
    
    # Slide 11: Error Handling and User Feedback
    create_content_slide(
        prs,
        "‚ö†Ô∏è Xatoliklarni Qayta Ishlash va Foydalanuvchi Javobi",
        """üîπ **Xatolik Turlari:**
   ‚Ä¢ "Siz admin emassiz!" - Huquq yo'q
   ‚Ä¢ "Guruh topilmadi!" - Guruh mavjud emas
   ‚Ä¢ "Noto'g'ri URL!" - Video URL noto'g'ri
   ‚Ä¢ "Mavsum allaqachon mavjud!" - Duplicate mavsum
   ‚Ä¢ "Database xatoligi!" - Database muammosi

üîπ **Muvaffaqiyat Xabarlari:**
   ‚Ä¢ "‚úÖ Centris Towers mavsum 2 dan boshlab videolar yuboriladi"
   ‚Ä¢ "‚úÖ Yangi mavsum 5 qo'shildi, 1 ta video"
   ‚Ä¢ "‚úÖ Sozlamalar muvaffaqiyatli yangilandi"

üîπ **Xatolik Qayta Ishlash:**
   ‚Ä¢ try-catch bloklari
   ‚Ä¢ User-friendly xatolik xabarlari
   ‚Ä¢ Logging va monitoring
   ‚Ä¢ Automatic retry mechanisms"""
    )
    
    # Slide 12: Integration with Video System
    create_content_slide(
        prs,
        "üé¨ Video Tizimi bilan Integratsiya",
        """üîπ **Video Yuborish Jarayoni:**
   ‚Ä¢ /set_group_video ‚Üí Video sozlamalari yangilanadi
   ‚Ä¢ Scheduler ‚Üí Yangi sozlamalar bo'yicha videolar yuboriladi
   ‚Ä¢ APScheduler ‚Üí Vaqt bo'yicha avtomatik yuborish
   ‚Ä¢ Progress tracking ‚Üí Video yuborish holati kuzatiladi

üîπ **Mavsum Qo'shish Natijasi:**
   ‚Ä¢ /add_season ‚Üí Yangi mavsum va videolar qo'shiladi
   ‚Ä¢ Video klaviaturasi ‚Üí Yangi mavsum ko'rsatiladi
   ‚Ä¢ Foydalanuvchilar ‚Üí Yangi videolarni ko'ra oladi
   ‚Ä¢ Admin panel ‚Üí Yangi mavsum boshqariladi

üîπ **Avtomatik Jarayonlar:**
   ‚Ä¢ Video rejalashtirish
   ‚Ä¢ Progress kuzatish
   ‚Ä¢ Error handling
   ‚Ä¢ User notifications"""
    )
    
    # Slide 13: Future Enhancements
    create_content_slide(
        prs,
        "üöÄ Kelajak Yaxshilanishlar va Yangi Funksiyalar",
        """üîπ **Admin Panel Yaxshilanishlari:**
   ‚Ä¢ Bulk operations - Bir necha guruhni bir vaqtda
   ‚Ä¢ Advanced filtering - Guruh va mavsum bo'yicha filtrlash
   ‚Ä¢ Statistics dashboard - Video yuborish statistikasi
   ‚Ä¢ User management - Foydalanuvchilarni boshqarish

üîπ **Video Boshqaruvi:**
   ‚Ä¢ Video categories - Video kategoriyalari
   ‚Ä¢ Content scheduling - Content rejalashtirish
   ‚Ä¢ Quality control - Video sifatini nazorat qilish
   ‚Ä¢ Backup systems - Zavol tizimlari

üîπ **Xavfsizlik:**
   ‚Ä¢ Two-factor authentication - Ikki bosqichli autentifikatsiya
   ‚Ä¢ Audit logging - Barcha harakatlarni qayd qilish
   ‚Ä¢ Role-based access control - Rol asosida huquq boshqaruvi
   ‚Ä¢ API rate limiting - API so'rovlarini cheklash"""
    )
    
    # Slide 14: Conclusion
    create_content_slide(
        prs,
        "‚úÖ Xulosa va Natijalar",
        """‚Ä¢ /set_group_video buyrug'i to'liq ishlayapti
‚Ä¢ /add_season buyrug'i super-admin uchun tayyor
‚Ä¢ Barcha admin funksiyalari xavfsiz va ishonchli
‚Ä¢ Database integratsiyasi professional
‚Ä¢ Xatoliklarni qayta ishlash tizimi to'liq
‚Ä¢ Foydalanuvchi interfeysi qulay va tushunarli
‚Ä¢ Video tizimi bilan to'liq integratsiya
‚Ä¢ Kelajakda rivojlantirish imkoniyatlari keng
‚Ä¢ Admin panel professional va funksional"""
    )
    
    # Slide 15: Thank You
    create_title_slide(
        prs,
        "üéâ Rahmat!",
        "Admin buyruqlari haqida so'rashganingiz uchun!\n\n/set_group_video va /add_season to'liq tushuntirildi!\n\nTayyorladi: AI Assistant\nSana: 31.08.2025"
    )
    
    # Faylni saqlash
    filename = "prezentatsiya_v5_admin_buyruqlar.pptx"
    prs.save(filename)
    
    print(f"‚úÖ PowerPoint presentation V5 muvaffaqiyatli yaratildi: {filename}")
    print(f"üìä Jami slaydlar soni: {len(prs.slides)}")
    print(f"üì± /set_group_video va /add_season buyruqlari to'liq tushuntirildi")
    print(f"üîπ Barcha funksiyalar va parametrlar ko'rsatildi")
    print(f"üá∫üáø O'zbek tilida tayyorlandi")
    print(f"üí° prezentatsiya_v2.pptx ga o'xshash professional ko'rinish")
    
    return filename

if __name__ == "__main__":
    try:
        filename = main()
        print(f"\nüé¨ {filename} fayli muvaffaqiyatli yaratildi!")
        print("üìÅ Fayl joriy papkada joylashgan")
        print("üì± Admin buyruqlari haqida to'liq ma'lumot")
        print("üí° Professional ko'rinish va tuzilish")
    except Exception as e:
        print(f"‚ùå Xatolik yuz berdi: {e}")
        print("üí° python-pptx kutubxonasi o'rnatilganligini tekshiring")
